\documentclass{noiassignment}

\begin{document}

%% 解题报告开始

\title{《ALOEXT》解题报告}
\author{佛山石中 李子豪}

\maketitle

\section{试题来源}


    可在BZOJ3217找到。

\section{试题大意}

    一个长度为N的序列，序列里每个数一开始有一个权值。
    
    然后进行M次操作。
    
    操作分为四种：
    
    1.插入一个数；
    
    2.删除一个数；
    
    3.修改某个数的权值；
    
    4.询问区间[l,r]中，选出一个数与某个数异或后得到的最大值。
    
    强制在线。
    
    $N,M \leq 10^5 ,$ 数的权值满足$0 \leq x < 2^{20} $.
    

\section{算法介绍}

\subsection{算法}

    这道题，有一种标准的解法，是通过重量平衡树套字母树解决，但并不是这里想要说的方法。
    
    这里想要说的，是梁泽宇曾在冬令营论文中说的一种方法，自己实现后感觉效果还不错。
    
    首先，着重要说的是取代重量平衡树的一个线段树。
    
    我们可以考虑给[0,$2^m-1$]的整数范围内给元素分配标号，建立一棵深度为(M+1)的满二叉树，并选定一个临界因子$\epsilon(0.5<\epsilon<1)$.
    
    然后给线段树每个点定义一个密度D(x)，表示子树中被元素占用的标号个数除以总标号个数的值。
    
    然后给高度为i（叶子节点高度为0）的节点设临界密度$\epsilon^{i}$,然后每次插入找到最高的不满足临界密度的节点进行线段树重建即可。
    
    然后，实际上，如果只记着被元素占用的标号的话，实际上就是一棵动态插入节点的线段树。
    
    之后，我们进行一定的分析。
    
    考虑标号范围：
    
    我们有：$(2\epsilon)^M \geq N$
    
    得到：$2^M \geq N^{log_{2\epsilon}2}$
    
    那么，就可以得出$\epsilon$各种取值所对应的标号范围了。一般为$O(N^2)$级别。
    
    然而，对于许多的题目，譬如这题，第二层需要嵌套一个字母树的话，那么往往乘上一个常数2的空间会非常的大，难以支持。
    
    因此，我们可以对嵌套的数据结构，进行类似“后缀树”的缩边处理。把只有一个儿子的节点缩去，即把链缩成一个点。
    
    通过这样转化之后，我们就能保证空间为$O(Nlog_{2}N)$.
    
    虽然代码复杂度增加了，但是这么一转换之后，我们可以发现速度也会大大提升。（PS：此题，我在BZOJ中排到了前十）
    
    通过上面的方法，我们就可以用一种新的方法在给定的时空限制内通过此题了。
    
        

\section{时空复杂度}
    空间复杂度$O(n log_{2} n)$,时间复杂度$O(n log_{2}^{2} n)$.

\section{总结}

    通过一种简单的线段树，代替原本的重量平衡树，可提高程序准确性，并且使用类似于后缀树压缩节点的方法，从而使原有的空间问题得到解决，并且速度也有了较大的改进。虽然代码量与平衡树相差不大（或者更大？？），但是更为好写，也更容易保证准确度。

%% 解题报告结束

\end{document}
