\documentclass{noiassignment}

\begin{document}

%% 解题报告开始

\title{Stanovi 解题报告}
\author{东营市胜利第一中学~~姜志豪}

\maketitle

\section{试题来源}

COCI 2015

bzoj提交：http://www.lydsy.com/JudgeOnline/problem.php?id=3810

\section{试题大意}

有一个~$n\times m$~的矩形~$A$~，由~$n\times m$~个~$1\times 1$~的单位正方形组成。

现在要将这个矩形划分成若干个区域，不能把一个单位正方形划分到多个区域中。

每个区域都必须是一个矩形，并且这个矩形至少有一条边在矩形~$A$~的边界上。

下图就是一种合法的划分方式。

\includegraphics[height=40mm]{1.png}

对于一个区域，若这个区域长为~$a$~，宽为~$b$~，那么这个区域的差异度是~$(ab-k)^2$~。

矩形~$A$~的差异度是所有区域差异度的和。

求矩形~$A$~的差异度的最小值。

$1\leq n,m\leq 300$

\section{算法介绍}

一种合法的方案，必定存在至少一条横线或竖线贯穿整个矩形，将矩形分成两个部分。比如像下图中红色的线。

\includegraphics[height=40mm]{2.png}

为了证明这个猜想，我们尝试构造一种方案，不存在横线或竖线贯穿整个矩形。

对于一条线~$a$~，为了避免它贯穿整个矩形，必须至少有一条与~$a$~垂直的线~$b$~挡住它。这时~$b$~又有可能贯穿整个矩形，那就必须至少有一条与~$b$~垂直的线~$c$~挡住~$b$~……

\includegraphics[height=45mm]{3.png}

所以，对于每一条线，都必须至少有一条线挡住它，避免它贯穿整个矩形。由于线的数量有限，所以挡的关系会形成一个环，比如~$a$~挡住~$b$~，~$b$~挡住~$c$~，~$c$~挡住~$d$~，~$d$~挡住~$a$~。如果挡的关系形成了一个环，就会出现一个矩形，满足它没有任何一条边在矩形~$A$~的边界上，这样不满足题目要求。所以，必定存在一条线贯穿整个矩形。

现在，我们可以通过dp来解决这个问题了。

令~$f(i,j,x)$~表示一个~$i\times j$~的矩形，边界情况为~$x$~时，划分后的最小差异度。其中~$x$~表示了这个矩形的每一条边是否在大矩形~$A$~的边界上，可以用4位的二进制数表示。计算~$f(i,j,x)$~时，分两种情况，一种情况是不对这个矩形继续划分，那么差异度是~$(ij-k)^2$~。另一种情况是继续划分，枚举哪一条线贯穿了这个矩形，计算此时的最小差异度，更新~$f(i,j,x)$~。

写记忆化搜索可以明显减少程序运行时间。

时间复杂度：~$O(\ nm(n+m)\ )$~

%% 解题报告结束

\end{document}
