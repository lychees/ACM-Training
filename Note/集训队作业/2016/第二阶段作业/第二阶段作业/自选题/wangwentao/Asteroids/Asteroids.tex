\documentclass{noiassignment}

\usepackage[colorlinks,citecolor=green,linkcolor=blue,menucolor=red,
			bookmarksnumbered=false,bookmarksopen=false,
			%unicode,					%Linux
			CJKbookmarks,				%windows
			pdftex]{hyperref}

\begin{document}

%% 解题报告开始

\title{Asteroids 解题报告}
\author{绍兴市第一中学~~王文涛}

\maketitle

\section{试题来源}

\href{https://www.codechef.com/JAN16/problems/ASTRD}
{CodeChef JAN16 ASTRD}

\section{试题大意}
三维空间中有一个圆心在原点、半径为整数$R$的地球。有$N$颗在地球外部的小行星，给定它们的整数坐标$(x_i,y_i,z_i)$。你需要在地球表面找到一个点使得这个点能看到的小行星数目最少。在某个点处可以看到某颗小行星当且仅当小行星比该点地平线高出至少$10^{-3}$ 单位的高度。有$T$ 组数据。

数据范围：
\begin{itemize}
	\item $ 1 \leq T \leq 10 $
	\item $ R-1 \leq |x_i|,|y_i|,|z_i| \leq 50 $
	\item Subtask 1: $ 1 \leq N \leq 2 $
	\item Subtask 2: $ 1 \leq N \leq 150 $
\end{itemize}

\section{算法介绍}

\subsection{Subtask 1: $N \leq 2$的情况}
想象一下，地球上可以看到某颗小行星的区域应该是一个圆。这些圆在球面上划分出若干块区域，而我们要求的就是在地球上被圆覆盖的次数最少的区域。由于每个圆的范围都不可能大于等于半球，所以2个圆不可能覆盖整个地球，答案必为0。

\subsection{Subtask 2}
我们可以想象，最优区域要么是两个圆相交后的交点处的外部，要么是不被任何圆覆盖的地方。

\subsubsection{两个圆相交后的交点处的外部的情况}
由于$10^{-3}$很小，而给定的都是整点，所以我们可以每次选择两个小行星，求出忽略$10^{-3}$后能看到小行星的两个圆，然后求出这两个圆的交点，在交点处按照上述做法判一下能看到多少小行星。因为忽略了$10^{-3}$之后的圆回比原来的圆略大一点，交点也在原来交点的外部。至于求交点，请看下一节中方法2\ref{approach 2}，这里的做法是一个特例。

\subsubsection{没有被任何圆覆盖的情况}
如果没有被任何圆覆盖的区域的边界有折线，就会被上面算到。所以只要考虑没有折线的情况。这只需要每个小行星对应的忽略$10^{-3}$的圆上随便选一个点判一下就好了。

时间复杂度：$O(N^3)$

\subsection{复杂度更优的做法}
考虑优化上述做法。我们直接求出所有真正的圆的交点，然后对于每个圆把这些交点按极角排序做一下就好了。关键在于如何求交点以及如何排序。

\subsubsection{方法1：直接求出圆，计算空间中圆与圆的交点}
对于求两个圆的交点，你可以先求出每个圆的圆心以及半径。你可以想象每个小行星处有一个半径为$10^{-3}$的小球，这个小球与地球的“内切线”在地球上划出的就是要求的圆。然后对于每个圆在圆心处以相应半径作一个球包住这个圆，那么两个圆的交点必然在两个球的“交面”内。求出这个“交面”，然后求出这个面与其中一个圆的交点即可。至于面和圆求交点，可以在圆心新建一个平面坐标系，然后求出面与这个平面的交线，这样就转化为平面上圆和直线求交了。排序也可以用这个平面坐标系。

然而这个做法太麻烦。

\subsubsection{方法2：直接求出交点三维坐标\label{approach 2}}
其实我们不需要真的去求圆与圆的交点。交点就是两个球与地球的公共“外切面”。我们可以转坐标系使得两个球的方向为$z$轴方向。这样就变成了$xOy$平面上地球和一个小球求切线，用一下三角函数就好了。这些显然都是可以算的。求出交点以后，只要再找到圆
心，在圆所在平面上对交点排序即可。这些都是可以通过建立坐标系、向量点积等方法实现。

建坐标系只要求出每个点在坐标系的三个基向量上的投影长度就可以确定在新坐标系中的坐标。

时间复杂度：$O(N^2 \log N)$，可以做比原题范围更大的、不是整数的数据。

%% 解题报告结束

\end{document}
