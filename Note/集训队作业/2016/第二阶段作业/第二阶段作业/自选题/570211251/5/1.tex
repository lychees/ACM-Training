\documentclass{noiassignment}
\usepackage[bookmarks=false, colorlinks, linkcolor=black, anchorcolor=black, citecolor=black, urlcolor=black]{hyperref}

\begin{document}

%% 解题报告开始

\title{梭哈游戏~~解题报告}
\author{宁波市镇海中学~~邹逍遥}

\maketitle

\section{试题来源}
CTSC 2012

\url{http://www.lydsy.com/JudgeOnline/problem.php?id=2804}

\section{试题大意}
A和B玩一个梭哈游戏。每个人获得5张牌然后比大小，大的一方赢。

给定A手上的$n$张牌和B手上的$n-1$张牌，剩下牌随机确定但两个人不会有相同的牌。求最后A的胜率。

比较大小时优先比较牌型：同花顺$>$四条$>$满堂红$>$同花$>$顺子$>$三条$>$两对$>$一对$>$无对。

假如牌型相同按照重要顺序比较牌的大小（例如两对优先比较大对子然后比较小对子然后比较单张，满堂红优先比较三条然后比较对子，顺子直接比较最大的那张），假如牌的大小也完全相同则按重要顺序比较花色。
\section{数据范围}
$1\leq n\leq 5$
\section{算法介绍}
\subsection{算法一}
枚举自己和对面最后的牌型，判掉所有不可能情况之后求出总方案数。

假如自己和对面最后的牌型一样需要加一些特判，可以类似数位dp递归到更细的分类讨论。

时间复杂度$O(\text{特别快})$

代码复杂度$O(\text{写不出})$

但是由于本题的时间限制并不紧，所以提升效率并不是最重要的，如何在考场上有限的时间内写出来显然更为重要。

所以我们需要寻找一种代码复杂度较低的做法。
\subsection{算法二}
首先考虑如何判断两手牌的大小。

容易看出比较只需要用到三个数据：整手牌的类型，5张牌的牌点根据重要性顺序压成的一个int，5张牌的花色根据重要性顺序压成的一个int。然后在比较的时候直接多关键字比较即可。

那么就是要对每手牌都处理出这三个数据。

假如枚举牌型一个一个判断是否满足并且每种牌型按不同的比较函数排序5张牌最后再合并的话会代码会非常长，而且复制粘贴部分较多，容易出错。

可以发现，压成struct的顺序只有三种：牌数量多的在前，牌大的在前，在顺子中较大的在前（因为顺子中有可能A是最小牌），预处理出这三种struct最后根据这手牌的所属情况选择一个即可。

然后考虑如何将牌型归类。

和上面类似，只需要先预处理出三个信息：是否全部同花，是否是顺子，以及和每张牌点数相同的牌的个数。

那么在判断一张牌是哪个类型的时候就只需要一个if里面加一两个判断就可以解决了。

代码不算太长，只需要1000B多一些。
\subsection{算法三}
考虑先暴力预处理出所有牌的组合形式。设$N=2598960$表示5张牌能组合出的所有情况。

利用上面的比较算法将所有牌排序，这样就可以很容易地比较两手牌的大小。

有了表之后如何解决原问题呢？暴力搜索所有可能的$O(N^2)$种情况显然不太靠谱，那么就要想办法将问题简化到$O(N)$级别。

首先来看一个简化版本：双方的手牌中可以有重复的牌。

那么只需要枚举A的手牌，然后统计一下比它小的牌中有多少个对B来说合法的方案即可。

假如不能重复，可以枚举每一张牌，减掉B的手牌包含这张牌的方案数。不过这样又会导致重复删除，所以需要一个$2^5$的容斥。

最终的算法就是：按牌型从小到大扫过来，使用hash表维护这些前缀牌型下，B的手牌在必定包含某些牌的情况下的方案数，同时使用容斥统计A拿到当前枚举到的手牌之后能战胜B的方案数。

时间复杂度$O(2^5N+N\log N)$



%% 解题报告结束

\end{document}
