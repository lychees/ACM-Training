\section{356E Xenia and String Problem}
\subsection*{试题大意}
如果一个串s是gray的，要满足3个条件：

1.长度是奇数

2.$s[\frac{|s|+1}{2}]$~在s中出现了1次。

3.要么~$|s|$~是1，要么~$s[1..\frac{|s|+1}{2}-1]$~和~$s[\frac{|s|+1}{2}+1..|s|]$~相同且都是gray 的。

一个字符串的价值为所有是gray的子串的长度平方之和。

现在给你一个长n的串，你可以改变其中一个字符，求最大价值。

串由小写字母构成。

长度~$N\leq 100000$

\subsection*{算法}
如果没有修改的话，算出每个位置为中心的最长的gary串，记长为f[i]，串的价值为~$\sum g[i]$ ，

$g[i]=1^2+3^2+7^2+...+f[i]^2$

若我们修改了i这个位置的字符，则那些包含i位置且i不是中心的gary串都不再是gary串了。那些原来正是因为i不和谐而无法成为gray串的变成了gray串。

前者我们可以用前缀和算出包含i的价值总和，后者考虑一个不是gary串变成了gary串，肯定是因为左右两边有一边包含了i，而i改变后变成gary串了。因此可以逆向从i 位置暴搜出去。因为每个从不是gray 串到是gray 串的那些串，都会被唯一的搜到。因此搜索的复杂度也是有保证的。

\subsection*{时间复杂度：$O(26nlogn)$，空间复杂度：$O(nlogn+26n)$}
