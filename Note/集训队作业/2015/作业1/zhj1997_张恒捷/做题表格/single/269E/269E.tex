\section{269E String Theory}
\subsection*{试题大意}
一个n*m的网格图，边的中点上有一个节点。有n+m条线，每条线连接两个节点。这两个节点不会再一条边上。

如图：

\includegraphics{single/269E/2.png}

现在可以交换两行或者两列，行/列上的节点也会相应调换。求一种行和列的排列方案使得没有两条线会交叉。

$n,m\leq 10^5$
\subsection*{算法}
如果没有两条线交叉，最终的形态是可以确定的，如图：

\includegraphics{single/269E/1.png}

把线分为两类，一类是四个角落上的，还有一类是中间的。

为了方便，假设每行两个端点连上线，每列的也类似。

先考虑角落上的：

角落上的肯定是一些长度为8的环。在原图中找到这些环后依次放入即可。

中间的就比较麻烦了，如上图所示。不妨假设n小于m，给横排的每个点编上编号后，可以看出上排编号为k 的点沿着边走，会走到下排编号为$((k+i-1)mod m+1)$号点。是一个差为i的循环。可以得出共有gcd(i,n) 个环（此处n为图中的n），若将线划分成连接上下，连接左上等等之类的，则第i个环从上排i号点开始走经过的边的模式都是相同的。因此在原图中找到这些环，然后做一下边模式的循环匹配即可。可以用kmp实现。

\subsection*{时间复杂度：$O(n+m)$，空间复杂度：$O(n+m)$}
