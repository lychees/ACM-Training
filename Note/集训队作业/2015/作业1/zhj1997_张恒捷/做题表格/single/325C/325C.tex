\section{325C Monsters and Diamonds}
\subsection*{试题大意}
Piegirl 发现一只怪物和一本关于怪物和馅饼的书。当她在读这本书的时候，她发现有 n 种怪物，每种都有一个唯一的 1 到 n 的编号。如果你喂怪物一块饼，它就会分成一定数量的怪物（可能为零），以及至少一个多彩的钻石。怪物们可能存在多种分裂方式。

最开始 Piegirl 有且只有一只怪物。她先喂了一块饼，它随之分裂。对于分出来的怪物，继续喂饼，直到它们都分裂为钻石。然后她把所有钻石收集起来。

你将得到一系列规则描述不同怪物的分裂方式，每种怪物至少有一种分裂方式。分裂的时候，如果有多种方式，Piegirl 可以选择任意一种。

你的任务是：对于每种怪物，确定以其为起始，Piegirl 可以得到的钻石最少最多分别是多少。Piegirl 有无限多的饼。

如果没办法将怪物都分为钻石，则输出 -1 -1。否则如果能分完所有怪物且得到无穷多的钻石，用 -2 作为无穷大。

$n,m\leq10^5$
\subsection*{算法}
先用拓扑序算出从每个怪物开始能否最终都变成钻石，如果可以的话可以顺便用优先队列求出最少能变成多少个。然后把不能的怪物全部去掉，再dfs一遍求出最多能变成多少钻石就可以了。

\subsection*{时间复杂度：$O(n+mlogn)$，空间复杂度：$O(n+m)$}
