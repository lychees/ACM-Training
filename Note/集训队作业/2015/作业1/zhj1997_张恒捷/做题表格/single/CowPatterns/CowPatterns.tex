\section{USACO 2005 December Gold Cow Patterns}
\subsection*{试题大意}
给定一个长为$n$的数串$A$，与一个长为$m$的模式串$B$。询问$A$有哪些子串与$B$ “匹配” 。两个数列“匹配”是指其数字的大小关系都相同。

$n,m \leq 10^5$
\subsection*{算法}
由于两个匹配的数列其所有对应的子序列都是匹配的，考虑直接使用kmp，这个时候kmp的匹配定义为数字大小关系都相同。对$B $做kmp 预处理，$next_i$ 表示 最大的长度$l$，使得$B_{1..l}$ 与 $B_{i-l+1..i}$ 的数字大小关系都相同。

现在考虑如何求出$next$数组。假如已经知道了$next_{1..i-1}$，和普通的kmp类似，用一个指针p从$next_{i-1}$开始，假如$B_{1-p}$中有一个数字$B_j$与$B_p+1$相同，则直接比较$B_i$与$B_{i-(p+1-j)}$的大小。如果相同的话匹配一定成功了。若没有数字与$B_{p+1}$相同，那就找$B_{1-p}$中比它大的最小的数字与比它小的最大的数字。用这两个数字来“夹住”它。如果匹配失败了，那$p$只能跳到$next_p$然后继续尝试匹配。

$B_{1-p}$中比$B_{p+1}$大的最小的数字与比它小的最大的数字，这个可以使用倒推+链表快速求出。

\subsection*{时间复杂度：$O(n)$，空间复杂度：$O(n)$}
