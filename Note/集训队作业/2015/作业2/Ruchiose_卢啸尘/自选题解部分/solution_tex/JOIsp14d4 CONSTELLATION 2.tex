\documentclass{noiassignment}

\begin{document}

%% 解题报告开始

\title{CONSTELLATION 2 解题报告}
\author{宁波镇海蛟川书院~~卢啸尘}

\maketitle

\section{试题来源}

IOI2014日本队选拔赛(第四试): 2人の星座

\section{试题大意}

平面直角坐标系上有$N$个点。点有三种颜色之一。

求，有多少对三角形，每个三角形的三个顶点异色，并且两个三角形（含内部）没有公共点？

$N \le 3000$，没有三点共线。

\section{一个初步算法}

我们考虑一对没有公共点的三角形有什么特点。

我们惊讶地发现，在端点取两个三角形的顶点所得到的的九条直线中，恰好有两条把这对三角形分割开来。

虽然根据三角形形态的不同，分割三角形的两条直线可能使用了某个三角形的同一个顶点，有些则没有，但是两条这个量是不变的。

这启示我们去枚举直线。枚举$O(N^2)$条直线，求出这条直线分割的三角形对数，然后把总和除以2即可。

总复杂度$O(N^3)$，尚不能通过此题。

\section{最终算法}

上面算法中的第三个$N$是怎么来的呢？就是说每次都要计算直线两侧各种颜色的点的数量。

我们可以换一种做法。我们枚举一个点，然后对其他点做极角排序。然后旋转第二个点所在的角度。这样子复杂度就降到了$O(N^2 log N)$，可以通过此题。

在这里每一对点被处理了两次，所以答案要除以4，而非2。

%% 解题报告结束

\end{document}
